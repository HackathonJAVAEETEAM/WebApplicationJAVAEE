<!DOCTYPE html>
<html xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:a4j="http://richfaces.org/a4j">
<head>
  <title>Details</title>
  <meta charset="utf-8"></meta>
  <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"></link>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"></link>
  <style>

body{background:url("resources/images/desk2.jpg") no-repeat center center fixed; }

nav ul{
    list-style-type: none;
}

nav .btn{
	margin: 20px;
}

nav ul::after{
    content: "";
    display: table;
    clear: both;
}

nav .deroulant{
	background-color: rgb(250,213,101,0.5);
}

nav a{
    display: block;
    text-decoration: none;
    color: black;
    border-top: 1px solid transparent;
    border-bottom: 2px solid transparent;
}

.sous{
    display: block;
    box-shadow: 1px 1px 2px #CCC;
    background-color: white;
}
nav > ul li:hover .sous{
    display: block;
}
.sous li{
    width: 100%;
}
.sous a{
    border-bottom: none;
}
.sous a:hover{
    border-bottom: none;
    background-color: RGBa(200,200,200,0.1);
}
.deroulant > a::after{
    content:" ▼";
    font-size: 12px;
}

.menuBtn{
	width:10vw;
}

body{
	margin-right:35px;
}

.row{
	margin-bottom: 40px;
}

.stafalse{
	background-color:rgba(255, 45, 25, 0.34);
}

.statrue{
	background-color:rgba(189, 238, 159, 0.87);
}

h2{
	text-align: center;
	width: 80%;
	margin:auto;
	padding-left:5%;
	padding-bottom:5%;
	text-decoration: underline;
	
}

.bulletin{

width:45%; 
background-color:rgba(255, 255, 255, 0.85);
color:#069;
float:left;
border-radius: 10px;
padding-right: 3%

}

.pae{

width:45%;
background-color:rgba(255, 255, 255, 0.85);
color:#069;
float:right;
border-radius:10px;
padding-right: 3%;

}

.feuille{
width: 95%;
margin-left: auto;
margin-right: auto;

}



</style>
  
</head>
<body style="margin-top: 2%;margin-left:4%; margin-right:4%">
<!--  Le fond d'écran présent sur cette page est tirée du site Pixabay.com, site de contenu libre de droit. Cette image a été créée par David Schwarzenberg -->

<div class="container-fluid">
	<div class="row d-flex justify-content-center">
		<div class="col-6">
			<u><h1 style="background-color:rgba(255, 255, 255, 0.65);color:#069; text-align:center; ">Détails de l'étudiant </h1></u>
	</div>
	</div>
	<div class="row" >
		<div class="col-3 d-flex justify-content-center">
			<h:form>
					<h:commandLink class="btn btn-info " action = "#{navigationController.goToHome()}" value = "" style="width: 200px"><i class="fa fa-chevron-left" aria-hidden="true">  </i>  Retour</h:commandLink>
			</h:form>
		</div>
		<div  style="background-color:rgba(255, 255, 255, 0.65);color:#069;text-align:center; width: 50%">
			 <h:dataTable value = "#{etudiantControl.etudiant}" var = "etudiant"
				styleClass = "etudiantTable2 w-100"
				headerClass = "etudiantTableHeader2"
				rowClasses = "etudiantTableOddRow2,etudiantTableEvenRow2"
				> 
		
			    <h:column>
			    	<f:facet name = "header">Nom et prénom</f:facet>
			    	#{etudiantControl.getEtudiant().getNom()}
				 </h:column>
			       <h:column>
				    <f:facet name="header">Matricule</f:facet>
				    #{etudiantControl.getEtudiant().getMatricule()}
			     </h:column>
			     <h:column>
			     	<f:facet name="header">Classe</f:facet>
			    	#{etudiantControl.getEtudiant().getClasse()}
			     </h:column>
			     <h:column>
			     	<f:facet name="header">Crédits valides</f:facet>
			    	#{etudiantControl.getEtudiant().getCreditsValides()}
			     </h:column>
			     <h:column>
			     	<f:facet name="header">Crédits totaux</f:facet>
			    	#{etudiantControl.getEtudiant().getCreditTot()}
			     </h:column>
			     <h:column styleClass ="sta#{etudiant.delibere}" >
			     	<f:facet name="header"  >Delibération</f:facet>
			    	#{etudiant.isDelibereStringFormat()}
			     </h:column>
		 </h:dataTable> 
	 	</div>
	 	<div class="col-3 d-flex justify-content-center" style="padding-top:0.1%">
			<h:form>
					<h:commandLink class="btn btn-info" action = "#{etudiantControl.changeStatus()}" value = ""  style="width: 200px">Changer Statut</h:commandLink>
			</h:form>
		</div>
	 </div>
</div>



	

<button class="btn btn-info" id="testBtn">Afficher/Masquer le bulletin</button>
<div class="container-fluid" style="width: 95%; padding-top: 3%">
	<div class="row">
		<div class="col-6 bulletin" id="bulletinToToggle">

			<h2>Bulletin en cours</h2>
			<nav>
			<h:form class="feuille">
				<ui:repeat value= "#{etudiantControl.getEtudiant().getUE()}" var="ue">
					<ul>
					  <li class="deroulant">
					    
					   	<p><b>#{ue.getUE().getNom()} #{ue.getUE().getTotalCredit()} Crédits </b>
							 <span style="float:right;padding-right:10px;">
							 	<h:selectBooleanCheckbox  value= "#{ue.reussi}" class="ueCheckbox">
							 	</h:selectBooleanCheckbox>
							 </span>
							 <b><span style="float:right;padding-right:15px;">#{ue.getPoints()}</span></b>
						 </p>
						 <ui:repeat value="#{ue.getAA()}" var="aa">
						 	<ul class="sous">
					      	 	<li>  	
									<p>#{aa.getAA().getNom()} #{aa.getAA().getCreditAA()} Crédit(s) 
										<span style="float:right;padding-right:10px;">
											<h:selectBooleanCheckbox value= "#{aa.reussi}" class="aaCheckbox">
											</h:selectBooleanCheckbox>
										</span>
										<span style="float:right;padding-right:15px;">#{aa.getPoints()}</span>
									</p>
					       		</li>
					       	</ul>
				       </ui:repeat>
					  </li>
				   </ul>
				</ui:repeat>
				<center>
					<h:commandButton class="btn btn-info w-75" action = "#{etudiantControl.persist()}" value = "Sauvegarder le bulletin" />
				</center>
				</h:form>
			</nav>
		</div>

		<div class="col-6 pae" id="divPae" style="padding-right:15px;">
			<h2 style="padding-bottom:20px;">PAE-Credits en cours: #{etudiantControl.getEtudiant().getPropPae().getCreditTotPropPae()}</h2>
			<c:choose>
				<c:when test="#{etudiantControl.isPaeNotEmpty()}">
				<center>
					<div style="display:in-line;">
					<center>
							<button class="btn btn-info" data-toggle="modal" data-target="#ajouterUe" style="width:45%"> Ajouter UE</button>
							<button class="btn btn-info" data-toggle="modal" data-target="#creerUePerso" style="width:45%"> Creer UE</button>
					</center>
					</div>
				</center>
					<nav>
						<h:form class="feuille">
							<center>
								<h:commandButton class="btn btn-info btn-block w-75" action="#{etudiantControl.generateAutoPae()}" value = "Regénérer un PAE" />
							</center>
							<ui:repeat value= "#{etudiantControl.getEtudiant().getPropPae().getListeUE()}" var="propUe">
								<ul>
								  <li class="deroulant">
								  	<p>
									  	<b>
									  		#{propUe.getNom()} 
									  		<h:commandLink type="button" class="close" style="float:right;" aria-label="Close" action="#{etudiantControl.removePropUe(propUe)}">
												<i class="fa fa-times" aria-hidden="true"></i>
											</h:commandLink> 
									  		<span style="float:right;padding-right:15px;">#{propUe.getTotalCredit()} Crédits </span>	
									  	</b>
								  	</p>
									 <ui:repeat value="#{propUe.getListeAA()}" var="propAa">
									 	<ul class="sous">
								      	 	<li>  	
												<p>#{propAa.getNom()} 
													<span style="float:right;padding-right:10px;">
													Dispenser étudiant?
														<h:selectBooleanCheckbox value= "#{propAa.dispense}"  class="aaCheckboxPae">
														</h:selectBooleanCheckbox>
													</span>
													<span style="float:right;padding-right:15px;">#{propAa.getCredits()} Crédit(s) </span>
												</p>
								       		</li>
								       	</ul>
							       	 </ui:repeat>
								  </li>
							   </ul>
							</ui:repeat>
							<center>
								<h:commandButton id="saveBtn" class="btn btn-info btn-block w-75" action="#{etudiantControl.updatePropPaeDispense()}" value = "Sauvegarder le PAE" />
							</center>
						</h:form>
					  </nav>
					</c:when>
					<c:otherwise>
						<h:form>
							<center>
								<h:commandButton class="btn btn-info btn-block w-75" action="#{etudiantControl.generateAutoPae()}" value = "Auto generer un PAE" />
							</center>
						</h:form>
					</c:otherwise>
			</c:choose>
		</div>
	</div>
</div>
	<script>
	$(document).ready(function(){
		$("#testBtn").click(function(){
		  $("#bulletinToToggle").toggle(function(){
			  $("#divPae").toggleClass("col-12");
		  }); 
		});
		$("#saveBtn").click(function(){
			  alert("Le PAE a bien été enregistré.");
		});
		
	});
	</script>
</body>
<!-- Modal -->
	  <div class="modal fade" id="ajouterUe" role="dialog">
	    <div class="modal-dialog modal-xl">
	      <!-- Modal content-->
	      <div class="modal-content">
	        
	        <div class="modal-header">
	          <button type="button" class="close" data-dismiss="modal"></button>
	          <h4 class="modal-title">Choisir UE et AA à ajouter.</h4>
	        </div>
	        <h:form>
		        <div class="modal-body" style="overflow-y: scroll; max-height:72.5vh;">
		        	<nav>
					
	
						<ui:repeat value= "#{etudiantControl.getListUeToPick()}" var="ue">
							<ul>
							  <li class="deroulant">  
							   	<p>
								   	<b>#{ue.getPropUe().getNom()}</b>
								   	<span style="float:right;padding-right:10px;">
										<h:selectBooleanCheckbox value= "#{ue.selected}" class="ueToSuggestCheckbox"></h:selectBooleanCheckbox>
									</span>
								</p>
								 <ui:repeat value="#{ue.getPropUe().getListeAA()}" var="aa">
								 	<ul class="sous">
							      	 	<li>  	
											<p>#{aa.getNom()}</p>
							       		</li>
							       	</ul>
						       </ui:repeat>
							  </li>
						   </ul>
						</ui:repeat>
						
						
					</nav>
		        </div>
		     
		    	 <div class="modal-footer">
		    	 	<h:commandButton class="btn btn-info w-100" value = "Sauvegarder" action="#{etudiantControl.addPropPae()}" />
					<h:commandButton class="btn btn-info" value="Ajouter le bloc précédent" action="#{etudiantControl.addPreviousBloc()}"/>
					<h:commandButton class="btn btn-info" value="Ajouter le bloc suivant" action="#{etudiantControl.addNextBloc()}"/>
		          	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        </div>
		        </h:form>
	      </div>
	    </div>
	  </div>
	  
	  <!-- Modal -->
	  <div class="modal fade" id="creerUePerso" role="dialog">
	    <div class="modal-dialog modal-xl">
	      <!-- Modal content-->
	      <div class="modal-content">
	        
	        <div class="modal-header">
	          <button type="button" class="close" data-dismiss="modal"></button>
	          <h4 class="modal-title">Creer une UE et l'ajouter au PAE</h4>
	        </div>
	        
	        <div class="modal-body">
	        	<nav>
					<h:form class="form-group">
							<h:inputText class="form-control" type="text" placeholder="Nom de l'unité d'enseignement" style="margin-bottom:20px"></h:inputText>
							
							<div id="inputContainer">
								<h:inputText class="form-control" type="text" placeholder="Nom de l'activité d'apprentissage"></h:inputText>
								<h:inputText class="form-control" type="number" placeholder="Nombre de crédits"></h:inputText>
							</div>
							<center>
								<h:commandButton class="btn btn-info w-75" value = "Sauvegarder la nouvelle UE" />
							</center>
					</h:form>
				</nav>
	        </div>
	        
	        <div class="modal-footer">
	          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        </div>
	      </div>
	    </div>
	  </div>
</html>